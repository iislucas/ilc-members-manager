<div class="mapping-table">
  <h3>Map Fields</h3>
  <p>
    Verify that the columns in your file match the correct fields. Check
    the examples below.
  </p>

  <div class="example-navigation">
    <button (click)="prevExample()" [disabled]="currentExampleIndex() === 0">
      Previous Example
    </button>
    <span>
      Row {{ currentExampleIndex() + 1 }} of {{ parsedData().length }}
    </span>
    <button (click)="nextExample()" [disabled]="currentExampleIndex() === parsedData().length - 1">
      Next Example
    </button>
  </div>

  <table>
    <thead>
      <tr>
        <th>Field</th>
        <th>CSV/JSONL Header</th>
        <th>Example Value</th>
      </tr>
    </thead>
    <tbody>
      @for (field of fieldsToMap(); track field) {
      <tr>
        <td>{{ field }}</td>
        <td>
          <select (change)="setOneMappingValue(field, $event)">
            <option value="">--Select Header--</option>
            @for (header of headers(); track header) {
            <option [value]="header" [selected]="mapping()[field] === header">
              {{ header }}
            </option>
            }
          </select>
        </td>
        <td>
          @if (mapping()[field]) {
          {{ currentExampleRow()[mapping()[field]] }}
          } @else {
          <span class="no-mapping">--</span>
          }
        </td>
      </tr>
      }
    </tbody>
  </table>
  <div class="stage-actions">
    <button class="primary" (click)="analyze.emit()">Next: Analyze Changes</button>
  </div>
</div>