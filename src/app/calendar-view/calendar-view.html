<div class="calendar-container">
  <div class="calendar-header">
    <div class="date-picker-container">
      <label for="today-date">Select Date:</label>
      <input
        #dateInput
        type="date"
        id="today-date"
        [value]="selectedDateString()"
        (change)="onDateChange($event)"
      />
    </div>
    <button (click)="refreshCalendar(selectedDate())">
      <app-icon name="refresh" /> Refresh
    </button>
  </div>

  <div class="class-section">
    <h2>Next Classes</h2>
    @let forthcoming = forthcomingClasses();
    @if (forthcoming.status === "loading") {
      <app-spinner></app-spinner>
    } @else if (forthcoming.status === "error") {
      <p class="error-message">{{ forthcoming.error }}</p>
    } @else {
      <ul>
        @for (event of forthcoming.data; track event.id) {
          <li [class.card]="isEventToday(event)">
            @if (event.start && event.start.dateTime) {
              <div class="event-time">
                {{ event.start.dateTime | date: "medium" }}
              </div>
            }
            <div class="event-summary">{{ event.summary }}</div>
            <div class="event-actions">
              @if (event.location) {
                <a [href]="getGoogleMapsLink(event.location)" target="_blank">
                  <app-icon name="map" />
                </a>
              }
              @if (event.htmlLink) {
                <a [href]="event.htmlLink" target="_blank">
                  <app-icon name="calendar_today" />
                </a>
              }
            </div>
          </li>
        } @empty {
          <li>No forthcoming classes.</li>
        }
      </ul>
    }
  </div>

  <div class="class-section">
    <h2>Previous Classes</h2>
    @let previous = previousClasses();
    @if (previous.status === "loading") {
      <app-spinner></app-spinner>
    } @else if (previous.status === "error") {
      <p class="error-message">{{ previous.error }}</p>
    } @else {
      <ul>
        @for (event of previous.data; track event.id) {
          <li>
            @if (event.start && event.start.dateTime) {
              <div class="event-time">
                {{ event.start.dateTime | date: "medium" }}
              </div>
            }
            <div class="event-summary">{{ event.summary }}</div>
            <div class="event-actions">
              @if (event.location) {
                <a [href]="getGoogleMapsLink(event.location)" target="_blank">
                  <app-icon name="map" />
                </a>
              }
              @if (event.htmlLink) {
                <a [href]="event.htmlLink" target="_blank">
                  <app-icon name="calendar_today" />
                </a>
              }
            </div>
          </li>
        } @empty {
          <li>No previous classes.</li>
        }
      </ul>
    }
  </div>
</div>
